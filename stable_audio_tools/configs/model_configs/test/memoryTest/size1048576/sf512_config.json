{
  "model_type": "autoencoder",
  "sample_size": 1048576,
  "sample_rate": 44100,
  "audio_channels": 2,
  "model": {
    "encoder": {
      "type": "oobleck",
      "config": {
        "in_channels": 2,
        "channels": 64,
        "c_mults": [
          1,
          2,
          4,
          8,
          16
        ],
        "strides": [
          2,
          4,
          4,
          4,
          4
        ],
        "latent_dim": 256,
        "use_snake": true
      }
    },
    "decoder": {
      "type": "oobleck",
      "config": {
        "out_channels": 2,
        "channels": 64,
        "c_mults": [
          1,
          2,
          4,
          8,
          16
        ],
        "strides": [
          2,
          4,
          4,
          4,
          4
        ],
        "latent_dim": 256,
        "use_snake": true,
        "final_tanh": false
      }
    },
    "bottleneck": {
      "type": "round_fsq",
      "config": {
        "latent_dim": 256,
        "dither": true
      }
    },
    "latent_dim": 256,
    "downsampling_ratio": 512,
    "io_channels": 2,
    "lm": {
      "backbone": {
        "depth": 8,
        "dim_heads": 64
      },
      "optimizer": {
        "type": "AdamW",
        "config": {
          "lr": 4e-05,
          "betas": [
            0.8,
            0.99
          ],
          "weight_decay": 0.001
        }
      }
    },
    "lm_weight": 1.0
  },
  "training": {
    "learning_rate": 0.00015,
    "warmup_steps": 0,
    "use_ema": true,
    "optimizer_configs": {
      "autoencoder": {
        "optimizer": {
          "type": "AdamW",
          "config": {
            "betas": [
              0.8,
              0.99
            ],
            "lr": 0.00015,
            "weight_decay": 0.001
          }
        },
        "scheduler": {
          "type": "InverseLR",
          "config": {
            "inv_gamma": 200000,
            "power": 0.5,
            "warmup": 0.999
          }
        }
      },
      "discriminator": {
        "optimizer": {
          "type": "AdamW",
          "config": {
            "betas": [
              0.8,
              0.99
            ],
            "lr": 0.0003,
            "weight_decay": 0.001
          }
        },
        "scheduler": {
          "type": "InverseLR",
          "config": {
            "inv_gamma": 200000,
            "power": 0.5,
            "warmup": 0.999
          }
        }
      }
    },
    "loss_configs": {
      "discriminator": {
        "type": "encodec",
        "config": {
          "filters": 64,
          "n_ffts": [
            2048,
            1024,
            512,
            256,
            128
          ],
          "hop_lengths": [
            512,
            256,
            128,
            64,
            32
          ],
          "win_lengths": [
            2048,
            1024,
            512,
            256,
            128
          ]
        },
        "weights": {
          "adversarial": 0.1,
          "feature_matching": 5.0
        }
      },
      "spectral": {
        "type": "mrstft",
        "config": {
          "fft_sizes": [
            2048,
            1024,
            512,
            256,
            128,
            64,
            32
          ],
          "hop_sizes": [
            512,
            256,
            128,
            64,
            32,
            16,
            8
          ],
          "win_lengths": [
            2048,
            1024,
            512,
            256,
            128,
            64,
            32
          ],
          "perceptual_weighting": true
        },
        "weights": {
          "mrstft": 1.0
        }
      },
      "time": {
        "type": "l1",
        "weights": {
          "l1": 0.0
        }
      }
    }
  }
}